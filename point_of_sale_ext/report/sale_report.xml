<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
<!--        <report-->
<!--                id="pos_ord_session_reprt"-->
<!--                string="Pos Order Report"-->
<!--                model="pos.session"-->
<!--                report_type="qweb-pdf"-->
<!--                file="point_of_sale_ext.pos_order_template"-->
<!--                name="point_of_sale_ext.pos_order_template"-->
<!--                paperformat_id="paperformat_pos_summary_report"/>-->

         <record id="paperformat_pos_summary_report" model="report.paperformat">
            <field name="name">A4</field>
            <field name="default" eval="True" />
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">40</field>
            <field name="margin_bottom">32</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">35</field>
            <field name="dpi">90</field>
        </record>


         <record id="pos_ord_session_reprt" model="ir.actions.report">
        <field name="name">Pos Order Report</field>
        <field name="model">pos.session</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">point_of_sale_ext.pos_order_template</field>
        <field name="report_file">point_of_sale_ext.pos_order_template</field>
        <field name="print_report_name">'Pos Order Report'</field>
        <field name="binding_model_id" ref="model_pos_session"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="paperformat_pos_summary_report"/>
    </record>

        <template id="pos_order_template">
            <t t-call="web.html_container">
                <t t-call="web.external_layout">
                    <div class="page">
                        <h2 align="center">POS Summary Report</h2>
                        <br/>
                        <div class="row">
                            <div class="col-3">
                                <span>Date:</span>
                                <span t-esc="time.strftime('%Y-%m-%d')"/>
                            </div>
                            <div class="col-3">
                                <span>Time:</span>
                                <span t-esc="time.strftime('%H:%M:%S')"/>
                            </div>
                        </div>
                        <div>
                            <span>Location:</span>
                            <span t-esc="location"/>
                        </div>
                        <div class="text-center">
                            <strong>
                                <center>Order Lines</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Product</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="orderline_total_qty" t-value="0" />
                                    <t t-set="orderline_total_sub_inc" t-value="0" />
<!--                                    <t t-set="orderline_total_tax" t-value="0" />-->
                                    <t t-set="orderline_total_sub" t-value="0" />
                                    <t t-foreach="env['pos.order.line'].get_order_line(orderlines)" t-as="order">
                                        <tr>
                                            <t t-set="orderline_total_qty" t-value="orderline_total_qty + order.get('qty', False)" />
                                            <t t-set="orderline_total_sub_inc" t-value="orderline_total_sub_inc + round(order.get('price_subtotal_incl', False), 2)" />
                                            <t t-set="orderline_total_sub" t-value="orderline_total_sub + round(order.get('price_subtotal', False), 2)" />
                                            <td>
                                                <span t-esc="order.get('full_product_name', False)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(order.get('qty', False), 1)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(order.get('price_subtotal_incl', False), 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(order.get('price_subtotal_incl', False) - order.get('price_subtotal', False), 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(order.get('price_subtotal', False), 2)"/>
                                            </td>
                                        </tr>
                                    </t>
<!--                                    border-top: 1px double black;-->
                                    <tr style="border-top: 5px double black;">
                                        <td>
                                            <b>Gross Sales</b>
                                        </td>
                                        <td>
                                            <b t-esc="orderline_total_qty"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(orderline_total_sub_inc, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(orderline_total_sub_inc - orderline_total_sub, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(orderline_total_sub, 2)"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <br/>
                        <div class="text-center">
                            <strong>
                                <center>Promotions</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Name of Promotions</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="promotion_total_qty" t-value="0" />
                                    <t t-set="promotion_total_sub_inc" t-value="0" />
                                    <t t-set="promotion_total_sub" t-value="0" />
                                    <t t-foreach="env['pos.order.line'].get_order_line(promotion_lines)" t-as="promo">
                                        <tr>
                                            <t t-set="promotion_total_qty" t-value="promotion_total_qty + promo.get('qty', False)" />
                                            <t t-set="promotion_total_sub_inc" t-value="promotion_total_sub_inc + round(promo.get('price_subtotal_incl', False), 2)" />
<!--                                            <t t-set="orderline_total_tax" t-value="orderline_total_tax + order.get('price_subtotal_incl', False) - order.get('price_subtotal', False)" />-->
                                            <t t-set="promotion_total_sub" t-value="promotion_total_sub + round(promo.get('price_subtotal', False), 2)" />
                                            <td>
                                                <span t-esc="promo.get('full_product_name', False)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(promo.get('qty', False), 1)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(promo.get('price_subtotal_incl', False), 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(promo.get('price_subtotal_incl', False) - promo.get('price_subtotal', False), 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(promo.get('price_subtotal', False), 2)"/>
                                            </td>
                                        </tr>
                                    </t>
<!--                                    border-top: 1px double black;-->
                                    <tr style="border-top: 5px double black;">
                                        <td>
                                            <b>Total Discounts</b>
                                        </td>
                                        <td>
                                            <b t-esc="round(promotion_total_qty, 1)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(promotion_total_sub_inc, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(promotion_total_sub_inc - promotion_total_sub, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(promotion_total_sub, 2)"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <br />
                        <div class="text-center">
                            <strong>
                                <center>Sales made by staff</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Therapist</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tips</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
<!--                                    env['pos.order'].read_group([('id', 'in', self.order_ids.ids)], fields=['amount_tax', 'amount_total', 'tip_amount'], groupby=['employee_id'])-->
<!--                                    env['pos.order.line'].read_group([('id', 'in', env['pos.order.line'].browse(orderlines).ids)], fields=['price_subtotal_incl', 'tax_ids_after_fiscal_position', 'price_subtotal'], groupby=['employee_id'])-->
                                    <t t-set="line_total_tip" t-value="0" />
                                    <t t-set="line_total_amount" t-value="0" />
                                    <t t-set="line_total_tax" t-value="0" />
                                    <t t-foreach="env['pos.order'].read_group([('id', 'in', order_ids)], fields=['amount_tax', 'amount_total', 'tip_amount'], groupby=['employee_id'])"
                                       t-as="line">
                                        <t t-set="line_total_tip" t-value="line_total_tip + round(line['tip_amount'], 2)" />
                                        <t t-set="line_total_amount" t-value="line_total_amount + round(line['amount_total'], 2)" />
                                        <t t-set="line_total_tax" t-value="line_total_tax + round(line['amount_tax'], 2)" />
                                        <tr>
                                            <td>
                                                <span t-if="line['employee_id'] and line['employee_id'][0]" t-esc="env['hr.employee'].browse(line['employee_id'][0]).name"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(line['tip_amount'], 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(line['amount_total'], 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(line['amount_tax'], 2)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(round(line['amount_total'], 2) - round(line['amount_tax'], 2), 2)"/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="border-top: 5px double black;">
                                        <td>
                                            <b>Total Sales made by staff</b>
                                        </td>
                                        <td>
                                            <b t-esc="round(line_total_tip, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(line_total_amount, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(line_total_tax, 2)"/>
                                        </td>
                                        <td>
                                            <b t-esc="round(line_total_amount - line_total_tax,2)"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <br/>
                        <div class="text-center">
                            <strong>
                                <center>Payment Modes</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Name</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tips</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="payment_tip_total" t-value="0" />
                                    <t t-set="payment_total_quantity" t-value="0" />
                                    <t t-set="payment_amount_total" t-value="0" />
                                    <t t-set="payment_tax_total" t-value="0" />
                                    <t t-set="payment_amount_without_tax" t-value="0" />
                                    <t t-foreach="env['pos.payment'].read_group([('session_id', '=', rec_id)], fields=['pos_order_id'], groupby=['payment_method_id'])"
                                        t-as="method">
                                        <t t-if="method['payment_method_id'] and method['payment_method_id'][0]">
                                            <t t-set="payment_tip_total" t-value="payment_tip_total + round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('tip_amount')), 2)" />
                                            <t t-set="payment_total_quantity" t-value="payment_total_quantity + len(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').ids)" />
                                            <t t-set="payment_amount_total" t-value="payment_amount_total + round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('lines').mapped('price_subtotal_incl')), 2)" />
                                            <t t-set="payment_tax_total" t-value="payment_tax_total + round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('amount_tax')), 2)" />
                                            <t t-set="payment_amount_without_tax" t-value="payment_amount_without_tax + round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('lines').mapped('price_subtotal')), 2)" />
                                        </t>
                                        <tr>
                                            <td>
<!--                                                env['pos.payment'].search_count([('session_id', '=', rec_id)])-->
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).payment_method_id.name"/>
                                            </td>
                                            <td>
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('tip_amount')), 2)"/>
                                            </td>
                                            <td>
<!--                                                mapped('lines').mapped('qty')-->
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="float(len(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').ids))"/>
                                            </td>
                                            <td>
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('lines').mapped('price_subtotal_incl')), 2)"/>
                                            </td>
                                            <td>
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('amount_tax')), 2)"/>
                                            </td>
                                            <td>
                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('lines').mapped('price_subtotal')), 2)"/>
                                            </td>
                                        </tr>
                                    </t>
<!--                                    <t t-esc="currency" />-->
                                    <t t-foreach="env['pos.order'].read_group([('id', 'in', order_ids)], fields=['amount_tax', 'amount_total', 'tip_amount', 'id'], groupby=['manual_currency_id'])"
                                        t-as="currency">
<!--                                        <div>-->
<!--                                            <t t-esc="currency" />-->
<!--                                            <t t-esc="currency['tip_amount']" />-->
<!--                                        </div>-->
                                        <tr>
                                            <td>
<!--                                                env['pos.payment'].search_count([('session_id', '=', rec_id)])-->
                                                <span t-if="currency['manual_currency_id'] and currency['manual_currency_id'][0]" t-esc="env['res.currency'].search([('id', '=', currency['manual_currency_id'][0])]).name"/>
                                            </td>
                                            <td>
                                                <span t-options="{'widget': 'monetary', 'display_currency': env['res.currency'].browse(int(currency['manual_currency_id'][0]))}" t-esc="env['pos.session'].convert_amount_to_currency(currency['tip_amount'], currency['manual_currency_id'][0])" />
<!--                                                <t t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0])"/>-->
<!--                                                , 'from_currency': env['pos.order.line'].get_currency()-->
<!--                                                env[res.currency]._convert(currency.tip_amount, env[res.currency].browse(int(currency['manual_currency_id'][0])), company_id)-->
<!--                                                <t t-esc="docids" />-->
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="env['pos.session'].convert_amount_to_currency(currency['tip_amount'], currency['manual_currency_id'][0])" />-->
                                            </td>
                                            <td>
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': env['res.currency'].browse(int(currency['manual_currency_id'][0]))}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0])" />-->
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0])" />-->
<!--                                                round(currency['manual_currency_id_count'], 1)-->
                                                <span t-esc="float(currency['manual_currency_id_count'])" />
                                            </td>
                                            <td>
                                                <span t-options="{'widget': 'monetary', 'display_currency': env['res.currency'].browse(int(currency['manual_currency_id'][0]))}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0])" />
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="round(env['res.currency']._convert(currency['amount_total'], env['res.currency'].browse(int(currency['manual_currency_id'][0])), company_id), 2)" />-->
                                            </td>
                                            <td>
                                                <span t-options="{'widget': 'monetary', 'display_currency': env['res.currency'].browse(int(currency['manual_currency_id'][0]))}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_tax'], currency['manual_currency_id'][0])" />
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_tax'], currency['manual_currency_id'][0])" />-->
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="round(env['res.currency']._convert(currency['amount_tax'], env['res.currency'].browse(int(currency['manual_currency_id'][0])), company_id), 2)" />-->
                                            </td>
                                            <td>
                                                <span t-options="{'widget': 'monetary', 'display_currency': env['res.currency'].browse(int(currency['manual_currency_id'][0]))}" t-esc="round(env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0]) - env['pos.session'].convert_amount_to_currency(currency['amount_tax'], currency['manual_currency_id'][0]), 2)" />
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="env['pos.session'].convert_amount_to_currency(currency['amount_total'], currency['manual_currency_id'][0]) - env['pos.session'].convert_amount_to_currency(currency['amount_tax'], currency['manual_currency_id'][0])" />-->
<!--                                                <span t-options="{'widget': 'monetary', 'display_currency': currency['manual_currency_id'][0]}" t-esc="round(env['res.currency']._convert(currency['amount_total'], env['res.currency'].browse(int(currency['manual_currency_id'][0])), company_id), 2)" />-->
                                            </td>
                                        </tr>
                                    </t>
<!--                                    <tr>-->
<!--                                        <td>-->
<!--                                            <b>Total Payment</b>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="payment_tip_total"/>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="payment_total_quantity"/>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="payment_amount_total"/>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="payment_tax_total"/>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="payment_amount_without_tax"/>-->
<!--                                        </td>-->
<!--                                    </tr>-->
                                </tbody>
                            </table>
                        </div>
<!--                        <t t-set="order_id" t-value="env['pos.session'].browse(rec_id).order_ids"/>-->
<!--                        <div t-if="any(order_id.filtered(lambda x:x.payment_given))" class="text-center">-->
<!--                            <strong>-->
<!--                                <center>Other Payment</center>-->
<!--                            </strong>-->
<!--                            <table class="table table-bordered">-->
<!--                                <thead>-->
<!--                                    <tr>-->
<!--                                        <th class="text-center">-->
<!--                                            <span>Order</span>-->
<!--                                        </th>-->

<!--                                        <th class="text-center">-->
<!--                                            <span>Amount</span>-->
<!--                                        </th>-->

<!--                                    </tr>-->
<!--                                </thead>-->
<!--                                <tbody>-->
<!--                                    <tr t-foreach="order_id.filtered(lambda x:x.payment_given)" t-as="order">-->
<!--                                        <td>-->
<!--                                            <span t-esc="order.name"/>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <span t-esc="order.payment_given"/>-->
<!--                                        </td>-->
<!--                                    </tr>-->
<!--                                    <tr>-->
<!--                                        <td>-->
<!--                                            <b>Total Amount</b>-->
<!--                                        </td>-->
<!--                                        <td>-->
<!--                                            <b t-esc="round(sum(order_id.mapped('other_payment')), 2)"/>-->
<!--                                        </td>-->
<!--                                    </tr>-->
<!--                                </tbody>-->
<!--                            </table>-->
<!--                        </div>-->
<!--                        <div class="text-center">-->
<!--                            <strong>-->
<!--                                <center>Tips</center>-->
<!--                            </strong>-->
<!--                            <table class="table table-bordered">-->
<!--                                <thead>-->
<!--                                    <tr>-->
<!--                                        <th class="text-center">-->
<!--                                            <span>Name</span>-->
<!--                                        </th>-->

<!--                                        <th class="text-center">-->
<!--                                            <span>Amount</span>-->
<!--                                        </th>-->

<!--                                    </tr>-->
<!--                                </thead>-->
<!--                                <tbody>-->
<!--                                    <t t-foreach="env['pos.payment'].read_group([('session_id', '=', rec_id)], fields=['pos_order_id'], groupby=['payment_method_id'])"-->
<!--                                       t-as="method">-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).payment_method_id.name"/>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <span t-if="method['payment_method_id'] and method['payment_method_id'][0]" t-esc="round(sum(env['pos.payment'].search([('payment_method_id', '=', method['payment_method_id'][0]), ('session_id', '=', rec_id)]).mapped('pos_order_id').mapped('cashier_tip_ids').mapped('tip')))"/>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                    </t>-->
<!--                                </tbody>-->
<!--                            </table>-->
<!--                        </div>-->
                        <t t-set="taxes" t-value="env['pos.order.line'].get_pos_tax(orderlines)"/>
                        <div t-if="taxes" class="text-center">
                            <strong>
                                <center>Tax</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Name</span>
                                        </th>

                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="taxes" t-foreach="taxes"
                                       t-as="tax">
                                        <tr>
                                            <td>
                                                <span t-esc="tax.get('name', False)"/>
                                            </td>
                                            <td>
                                                <span t-esc="round(tax.get('tax_amount', False), 2)"/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                        <br/>
                        <div>
                            <Strong align="center">Gross Sales:</Strong>
                            <span t-options="{'widget': 'monetary', 'from_currency': env['pos.order.line'].get_currency(), 'display_currency': env['pos.order.line'].get_currency()}" t-esc="round(orderline_total_sub_inc, 2)"/>
                            <br/>
                            <Strong align="center">Discount Amount:</Strong>
                            <span t-options="{'widget': 'monetary', 'from_currency': env['pos.order.line'].get_currency(), 'display_currency': env['pos.order.line'].get_currency()}" t-esc="round(discount_amount, 2)"/>
                            <br/>
<!--                             in <t t-esc="env['pos.order.line'].get_currency().name"/> without Tax-->
                            <Strong align="center">Total:</Strong>
                            <span t-options="{'widget': 'monetary', 'from_currency': env['pos.order.line'].get_currency(), 'display_currency': env['pos.order.line'].get_currency()}" t-esc="round(total_with_tax_aed, 2)"/>
                            <br/>
                            <Strong align="center">Tax:</Strong>
                            <span t-options="{'widget': 'monetary', 'from_currency': env['pos.order.line'].get_currency(), 'display_currency': env['pos.order.line'].get_currency()}" t-esc="round(total_tax, 2)"/>
                            <br/>
                            <Strong align="center">Net Sales:</Strong>
                            <span t-options="{'widget': 'monetary', 'from_currency': env['pos.order.line'].get_currency(), 'display_currency': env['pos.order.line'].get_currency()}" t-esc="round(total_without_tax_aed, 2)"/>
                            <br/>
                            <Strong align="center">Number Of Transactions:</Strong>
                            <span t-esc="env['pos.payment'].search_count([('session_id', '=', rec_id)])"/>
<!--                            <br/>-->
<!--                            <Strong align="center">Discount Amount:</Strong>-->
<!--                            <span t-esc="env['pos.session'].browse(rec_id).get_discount()"/>-->
                        </div>
                        <div t-if="is_us and env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product')" class="text-center">
                            <strong>
                                <center>Product without tax &amp; product tax</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <span t-esc="sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('qty'))"/>
                                        </td>
                                        <td>

                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('price_subtotal_incl')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('order_id').mapped('amount_tax')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('price_subtotal')))"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div t-if="is_us and env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product')" class="text-center">
                            <strong>
                                <center>Product without tax &amp; product tax</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <span t-esc="sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('qty'))"/>
                                        </td>
                                        <td>

                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('price_subtotal_incl')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('order_id').mapped('amount_tax')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'product').mapped('price_subtotal')))"/>
                                        </td>

                                    </tr>

                                </tbody>
                            </table>
                        </div>
                        <div t-if="is_us and env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service')" class="text-center">
                            <strong>
                                <center>Services without tax &amp; service tax</center>
                            </strong>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <span>Quantity</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Tax</span>
                                        </th>
                                        <th class="text-center">
                                            <span>Amount Without Tax</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
<!--                                    <t t-foreach="env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service')" t-as="order">-->
                                        <tr>
                                            <td>
                                            <span t-esc="sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service').mapped('qty'))"/>
                                        </td>
                                        <td>

                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service').mapped('price_subtotal_incl')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service').mapped('order_id').mapped('amount_tax')))"/>
                                        </td>
                                        <td>
                                            <span t-esc="round(sum(env['pos.order.line'].browse(orderlines).filtered(lambda o: o.product_id.detailed_type == 'service').mapped('price_subtotal')))"/>
                                        </td>
                                        </tr>
<!--                                    </t>-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </t>
            </t>
        </template>


    </data>
</odoo>
